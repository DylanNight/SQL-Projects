
SELECT *
FROM Retail
ORDER BY Date

--Q1. What is the total revenue generated by the company during a specific time period?

--Calculating total revenue 
SELECT SUM([Total Amount])
FROM Retail

SELECT Date,SUM([Total Amount])
FROM Retail
GROUP BY Date

--Q2. What is the average price per unit for each product category?

SELECT MAX(X.[Average price per unit])
FROM (SELECT [Product Category],AVG([Price per Unit]) AS [Average price per unit]
	FROM Retail
	GROUP BY [Product Category]) X



--Calculating average price per unit for each category
SELECT [Product Category],AVG([Price per Unit]) AS [Average price per unit]
FROM Retail
GROUP BY [Product Category]




--Q3. What is the total quantity sold for each product category?

SELECT [Product Category],SUM(Quantity) AS [Total Quantity purchased]
FROM Retail
GROUP BY [Product Category]


--Q4. What is the total revenue generated by each gender group?

SELECT Gender,SUM([Total Amount]) AS [Total Revenue]
FROM Retail
GROUP BY Gender


--Q5. What is the total revenue generated by different age groups?
SELECT Age,SUM([Total Amount]) AS [Total Revenue]
FROM Retail
GROUP BY Age 
ORDER BY 2 DESC

--Q6. What is the most profitable product category in terms of total revenue?

SELECT [Product Category],SUM([Total Amount]) AS [Revenue]
FROM Retail
GROUP BY [Product Category]
ORDER BY 2 DESC


--Q7. Can you identify any trends or patterns in sales over time, such as seasonality or monthly sales trends?

SELECT MAX(Date),MIN(Date)
FROM Retail

--Overall look at copany profit over time 
SELECT Date,SUM([Total Amount]) AS [Total Revenue]
FROM Retail
GROUP BY Date
ORDER BY Date

--Look into company profits for each quater 
SELECT DATENAME(QQ,Date),SUM([Total Amount]) AS [Total Revenue]
FROM Retail
GROUP BY DATENAME(QQ,Date)
ORDER BY DATENAME(QQ,Date)

--Look into company profit for each month 
SELECT DATENAME(MONTH,Date),SUM([Total Amount]) AS [Total Revenue]
FROM Retail
GROUP BY DATENAME(MONTH,Date)
ORDER BY DATENAME(MONTH,Date)

--Look into company profits for each day
SELECT DATENAME(WEEKDAY,Date),SUM([Total Amount]) AS [Total Revenue]
FROM Retail
GROUP BY DATENAME(WEEKDAY,Date)
ORDER BY DATENAME(WEEKDAY,Date)

--Q9. Are there any correlations between age groups and the types of products purchased?

--When Age is plotted against total quantity will show if theres a corrolation 
SELECT [Product Category],Age,SUM(Quantity) AS [total quantity]
FROM Retail
WHERE [Product Category]='Beauty'
GROUP BY Age,[Product Category]

SELECT [Product Category],Age,SUM(Quantity) AS [total quantity]
FROM Retail
WHERE [Product Category]='Clothing'
GROUP BY Age,[Product Category]

SELECT [Product Category],Age,SUM(Quantity) AS [total quantity]
FROM Retail
WHERE [Product Category]='Electronics'
GROUP BY Age,[Product Category]

--Q10. Can you identify any significant differences in shopping behavior between different gender groups, such as preferred product categories or average transaction value?

--Calculates the Average quantity per transaction for each gender and product catergory
SELECT X.[Product Category],X.[Male Avg Quantity],Y.[Female Avg Quantity]
FROM 
(SELECT Gender,[Product Category],AVG(Quantity) AS [Male Avg Quantity]
FROM Retail
WHERE Gender='Male'
GROUP BY Gender,[Product Category]) X
JOIN
(SELECT Gender,[Product Category],AVG(Quantity) AS [Female Avg Quantity]
FROM Retail
WHERE Gender='Female'
GROUP BY Gender,[Product Category]) Y
ON X.[Product Category]=Y.[Product Category]

--Calculates the prefresnse based on count of transactions based on gender

SELECT X.[Product Category],X.[Female Pref],Y.[Male Pref]
FROM
(SELECT Gender,[Product Category],COUNT([Product Category]) AS [Female Pref]
FROM Retail
WHERE Gender = 'Female'
GROUP BY Gender,[Product Category]) X
JOIN
(SELECT Gender,[Product Category],COUNT([Product Category]) AS [Male Pref]
FROM Retail
WHERE Gender = 'Male'
GROUP BY Gender,[Product Category]) Y
ON X.[Product Category]=Y.[Product Category]

--Q11. What is the average transaction value for each product category?

SELECT [Product Category],AVG(Quantity)
FROM Retail
GROUP BY [Product Category]

--Q12. Can you identify any outliers in terms of unusually high or low-priced products?

SELECT [Product Category],MAX([Price per Unit]) AS MaxPricedProduct,MIN([Price per Unit]) AS MinPricedProduct
FROM Retail
GROUP BY [Product Category]

--Q14. What is the distribution of customer ages within each product category?

SELECT [Product Category],AVG(Age) AvgAge,STDEV(Age) StdAge
FROM Retail
GROUP BY [Product Category]

--Q15. Can you identify any correlations between customer age and the average price per unit or total spending per transaction?
--Can plot the Avg money spent against age to detemine correlation between also by plotting them both on the same graph
--can determine which gender is more likely to spend money at each age 
SELECT X.Age,X.FemaleAvgSpend,Y.MaleAvgSpend
FROM 
(SELECT Age,Gender,AVG([Total Amount]) FemaleAvgSpend
FROM Retail
WHERE Gender ='Female'
GROUP BY Age,Gender) X
JOIN
(SELECT Age,Gender,AVG([Total Amount]) MaleAvgSpend
FROM Retail
WHERE Gender ='Male'
GROUP BY Age,Gender) Y 
	ON Y.Age=X.Age


--Q15. Can you determine the customer demographics (age and gender) that contribute the most to overall revenue?
--Percentage of revenue split into gender 
SELECT Gender,(SUM([Total Amount])*100/(SELECT SUM([Total Amount]) TotalRev FROM Retail)) PercentageRevenue
FROM Retail
GROUP BY Gender

--Percntage of revenue split into gender and product catergory
SELECT Gender,[Product Category],(SUM([Total Amount])*100/(SELECT SUM([Total Amount]) TotalRev FROM Retail)) PercentageRevenue
FROM Retail
GROUP BY Gender,[Product Category]
ORDER BY 3 DESC

--Calculating Total Revenue
SELECT SUM([Total Amount]) TotalRev
FROM Retail


